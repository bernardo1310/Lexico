<?php

require_once("token.php");

// ============================================================================
// AUTÔMATO FINITO DETERMINÍSTICO - ANALISADOR LÉXICO
// ============================================================================

$afd = array(
    // ESTADO INICIAL q0
    "q0" => array(
        // Espaços
        " "  => "q5",
        
        // Delimitadores
        "("  => "q6",   // Abre parênteses  
        ")"  => "q7",   // Fecha parênteses
        "{"  => "q9",   // Início bloco
        "}"  => "q33",  // Fim bloco
        ";"  => "q32",  // Ponto e vírgula
        
        // Operadores
        ">"  => "q8",   // Maior
        "<"  => "q34",  // Menor  
        "="  => "q35",  // Atribuição
        "*"  => "q28",  // Multiplicação
        "+"  => "q30",  // Soma
        "-"  => "q29",  // Subtração
        "/"  => "q31",  // Divisão
        
        // Dígitos
        "0" => "q3", "1" => "q3", "2" => "q3", "3" => "q3", "4" => "q3",
        "5" => "q3", "6" => "q3", "7" => "q3", "8" => "q3", "9" => "q3",
        
        // Letras - palavras-chave e identificadores
        "a" => "q4", "b" => "q4", "c" => "q4", "d" => "q4", "e" => "q38", // else
        "f" => "q10", "g" => "q4", "h" => "q4", "i" => "q1", "j" => "q4",  // for, if
        "k" => "q4", "l" => "q4", "m" => "q4", "n" => "q4", "o" => "q4",
        "p" => "q18", "q" => "q4", "r" => "q23", "s" => "q4", "t" => "q4", // print, read
        "u" => "q4", "v" => "q39", "w" => "q13", "x" => "q4", "y" => "q4", // var, while
        "z" => "q4"
    ),

    // ========================================================================
    // RECONHECIMENTO: IF
    // ========================================================================
    "q1" => array( // i
        "0" => "q4", "1" => "q4", "2" => "q4", "3" => "q4", "4" => "q4", "5" => "q4", "6" => "q4", "7" => "q4", "8" => "q4", "9" => "q4",
        "a" => "q4", "b" => "q4", "c" => "q4", "d" => "q4", "e" => "q4", "f" => "q2", "g" => "q4", "h" => "q4", "i" => "q4", "j" => "q4",
        "k" => "q4", "l" => "q4", "m" => "q4", "n" => "q4", "o" => "q4", "p" => "q4", "q" => "q4", "r" => "q4", "s" => "q4", "t" => "q4",
        "u" => "q4", "v" => "q4", "w" => "q4", "x" => "q4", "y" => "q4", "z" => "q4"
    ),
    
    "q2" => array( // if
        "0" => "q4", "1" => "q4", "2" => "q4", "3" => "q4", "4" => "q4", "5" => "q4", "6" => "q4", "7" => "q4", "8" => "q4", "9" => "q4",
        "a" => "q4", "b" => "q4", "c" => "q4", "d" => "q4", "e" => "q4", "f" => "q4", "g" => "q4", "h" => "q4", "i" => "q4", "j" => "q4",
        "k" => "q4", "l" => "q4", "m" => "q4", "n" => "q4", "o" => "q4", "p" => "q4", "q" => "q4", "r" => "q4", "s" => "q4", "t" => "q4",
        "u" => "q4", "v" => "q4", "w" => "q4", "x" => "q4", "y" => "q4", "z" => "q4"
    ),

    // ========================================================================
    // RECONHECIMENTO: FOR  
    // ========================================================================
    "q10" => array( // f
        "0" => "q4", "1" => "q4", "2" => "q4", "3" => "q4", "4" => "q4", "5" => "q4", "6" => "q4", "7" => "q4", "8" => "q4", "9" => "q4",
        "a" => "q4", "b" => "q4", "c" => "q4", "d" => "q4", "e" => "q4", "f" => "q4", "g" => "q4", "h" => "q4", "i" => "q4", "j" => "q4",
        "k" => "q4", "l" => "q4", "m" => "q4", "n" => "q4", "o" => "q11", "p" => "q4", "q" => "q4", "r" => "q4", "s" => "q4", "t" => "q4",
        "u" => "q4", "v" => "q4", "w" => "q4", "x" => "q4", "y" => "q4", "z" => "q4"
    ),
    
    "q11" => array( // fo
        "0" => "q4", "1" => "q4", "2" => "q4", "3" => "q4", "4" => "q4", "5" => "q4", "6" => "q4", "7" => "q4", "8" => "q4", "9" => "q4",
        "a" => "q4", "b" => "q4", "c" => "q4", "d" => "q4", "e" => "q4", "f" => "q4", "g" => "q4", "h" => "q4", "i" => "q4", "j" => "q4",
        "k" => "q4", "l" => "q4", "m" => "q4", "n" => "q4", "o" => "q4", "p" => "q4", "q" => "q4", "r" => "q12", "s" => "q4", "t" => "q4",
        "u" => "q4", "v" => "q4", "w" => "q4", "x" => "q4", "y" => "q4", "z" => "q4"
    ),
    
    "q12" => array( // for
        "0" => "q4", "1" => "q4", "2" => "q4", "3" => "q4", "4" => "q4", "5" => "q4", "6" => "q4", "7" => "q4", "8" => "q4", "9" => "q4",
        "a" => "q4", "b" => "q4", "c" => "q4", "d" => "q4", "e" => "q4", "f" => "q4", "g" => "q4", "h" => "q4", "i" => "q4", "j" => "q4",
        "k" => "q4", "l" => "q4", "m" => "q4", "n" => "q4", "o" => "q4", "p" => "q4", "q" => "q4", "r" => "q4", "s" => "q4", "t" => "q4",
        "u" => "q4", "v" => "q4", "w" => "q4", "x" => "q4", "y" => "q4", "z" => "q4"
    ),

    // ========================================================================
    // RECONHECIMENTO: WHILE
    // ========================================================================
    "q13" => array( // w
        "0" => "q4", "1" => "q4", "2" => "q4", "3" => "q4", "4" => "q4", "5" => "q4", "6" => "q4", "7" => "q4", "8" => "q4", "9" => "q4",
        "a" => "q4", "b" => "q4", "c" => "q4", "d" => "q4", "e" => "q4", "f" => "q4", "g" => "q4", "h" => "q14", "i" => "q4", "j" => "q4",
        "k" => "q4", "l" => "q4", "m" => "q4", "n" => "q4", "o" => "q4", "p" => "q4", "q" => "q4", "r" => "q4", "s" => "q4", "t" => "q4",
        "u" => "q4", "v" => "q4", "w" => "q4", "x" => "q4", "y" => "q4", "z" => "q4"
    ),
    
    "q14" => array( // wh
        "0" => "q4", "1" => "q4", "2" => "q4", "3" => "q4", "4" => "q4", "5" => "q4", "6" => "q4", "7" => "q4", "8" => "q4", "9" => "q4",
        "a" => "q4", "b" => "q4", "c" => "q4", "d" => "q4", "e" => "q4", "f" => "q4", "g" => "q4", "h" => "q4", "i" => "q15", "j" => "q4",
        "k" => "q4", "l" => "q4", "m" => "q4", "n" => "q4", "o" => "q4", "p" => "q4", "q" => "q4", "r" => "q4", "s" => "q4", "t" => "q4",
        "u" => "q4", "v" => "q4", "w" => "q4", "x" => "q4", "y" => "q4", "z" => "q4"
    ),
    
    "q15" => array( // whi
        "0" => "q4", "1" => "q4", "2" => "q4", "3" => "q4", "4" => "q4", "5" => "q4", "6" => "q4", "7" => "q4", "8" => "q4", "9" => "q4",
        "a" => "q4", "b" => "q4", "c" => "q4", "d" => "q4", "e" => "q4", "f" => "q4", "g" => "q4", "h" => "q4", "i" => "q4", "j" => "q4",
        "k" => "q4", "l" => "q16", "m" => "q4", "n" => "q4", "o" => "q4", "p" => "q4", "q" => "q4", "r" => "q4", "s" => "q4", "t" => "q4",
        "u" => "q4", "v" => "q4", "w" => "q4", "x" => "q4", "y" => "q4", "z" => "q4"
    ),
    
    "q16" => array( // whil
        "0" => "q4", "1" => "q4", "2" => "q4", "3" => "q4", "4" => "q4", "5" => "q4", "6" => "q4", "7" => "q4", "8" => "q4", "9" => "q4",
        "a" => "q4", "b" => "q4", "c" => "q4", "d" => "q4", "e" => "q17", "f" => "q4", "g" => "q4", "h" => "q4", "i" => "q4", "j" => "q4",
        "k" => "q4", "l" => "q4", "m" => "q4", "n" => "q4", "o" => "q4", "p" => "q4", "q" => "q4", "r" => "q4", "s" => "q4", "t" => "q4",
        "u" => "q4", "v" => "q4", "w" => "q4", "x" => "q4", "y" => "q4", "z" => "q4"
    ),
    
    "q17" => array( // while
        "0" => "q4", "1" => "q4", "2" => "q4", "3" => "q4", "4" => "q4", "5" => "q4", "6" => "q4", "7" => "q4", "8" => "q4", "9" => "q4",
        "a" => "q4", "b" => "q4", "c" => "q4", "d" => "q4", "e" => "q4", "f" => "q4", "g" => "q4", "h" => "q4", "i" => "q4", "j" => "q4",
        "k" => "q4", "l" => "q4", "m" => "q4", "n" => "q4", "o" => "q4", "p" => "q4", "q" => "q4", "r" => "q4", "s" => "q4", "t" => "q4",
        "u" => "q4", "v" => "q4", "w" => "q4", "x" => "q4", "y" => "q4", "z" => "q4"
    ),

    // ========================================================================
    // RECONHECIMENTO: PRINT
    // ========================================================================
    "q18" => array( // p
        "0" => "q4", "1" => "q4", "2" => "q4", "3" => "q4", "4" => "q4", "5" => "q4", "6" => "q4", "7" => "q4", "8" => "q4", "9" => "q4",
        "a" => "q4", "b" => "q4", "c" => "q4", "d" => "q4", "e" => "q4", "f" => "q4", "g" => "q4", "h" => "q4", "i" => "q4", "j" => "q4",
        "k" => "q4", "l" => "q4", "m" => "q4", "n" => "q4", "o" => "q4", "p" => "q4", "q" => "q4", "r" => "q19", "s" => "q4", "t" => "q4",
        "u" => "q4", "v" => "q4", "w" => "q4", "x" => "q4", "y" => "q4", "z" => "q4"
    ),
    
    "q19" => array( // pr
        "0" => "q4", "1" => "q4", "2" => "q4", "3" => "q4", "4" => "q4", "5" => "q4", "6" => "q4", "7" => "q4", "8" => "q4", "9" => "q4",
        "a" => "q4", "b" => "q4", "c" => "q4", "d" => "q4", "e" => "q4", "f" => "q4", "g" => "q4", "h" => "q4", "i" => "q20", "j" => "q4",
        "k" => "q4", "l" => "q4", "m" => "q4", "n" => "q4", "o" => "q4", "p" => "q4", "q" => "q4", "r" => "q4", "s" => "q4", "t" => "q4",
        "u" => "q4", "v" => "q4", "w" => "q4", "x" => "q4", "y" => "q4", "z" => "q4"
    ),
    
    "q20" => array( // pri
        "0" => "q4", "1" => "q4", "2" => "q4", "3" => "q4", "4" => "q4", "5" => "q4", "6" => "q4", "7" => "q4", "8" => "q4", "9" => "q4",
        "a" => "q4", "b" => "q4", "c" => "q4", "d" => "q4", "e" => "q4", "f" => "q4", "g" => "q4", "h" => "q4", "i" => "q4", "j" => "q4",
        "k" => "q4", "l" => "q4", "m" => "q4", "n" => "q21", "o" => "q4", "p" => "q4", "q" => "q4", "r" => "q4", "s" => "q4", "t" => "q4",
        "u" => "q4", "v" => "q4", "w" => "q4", "x" => "q4", "y" => "q4", "z" => "q4"
    ),
    
    "q21" => array( // prin
        "0" => "q4", "1" => "q4", "2" => "q4", "3" => "q4", "4" => "q4", "5" => "q4", "6" => "q4", "7" => "q4", "8" => "q4", "9" => "q4",
        "a" => "q4", "b" => "q4", "c" => "q4", "d" => "q4", "e" => "q4", "f" => "q4", "g" => "q4", "h" => "q4", "i" => "q4", "j" => "q4",
        "k" => "q4", "l" => "q4", "m" => "q4", "n" => "q4", "o" => "q4", "p" => "q4", "q" => "q4", "r" => "q4", "s" => "q4", "t" => "q22",
        "u" => "q4", "v" => "q4", "w" => "q4", "x" => "q4", "y" => "q4", "z" => "q4"
    ),
    
    "q22" => array( // print
        "0" => "q4", "1" => "q4", "2" => "q4", "3" => "q4", "4" => "q4", "5" => "q4", "6" => "q4", "7" => "q4", "8" => "q4", "9" => "q4",
        "a" => "q4", "b" => "q4", "c" => "q4", "d" => "q4", "e" => "q4", "f" => "q4", "g" => "q4", "h" => "q4", "i" => "q4", "j" => "q4",
        "k" => "q4", "l" => "q4", "m" => "q4", "n" => "q4", "o" => "q4", "p" => "q4", "q" => "q4", "r" => "q4", "s" => "q4", "t" => "q4",
        "u" => "q4", "v" => "q4", "w" => "q4", "x" => "q4", "y" => "q4", "z" => "q4"
    ),

    // ========================================================================
    // RECONHECIMENTO: READ
    // ========================================================================
    "q23" => array( // r
        "0" => "q4", "1" => "q4", "2" => "q4", "3" => "q4", "4" => "q4", "5" => "q4", "6" => "q4", "7" => "q4", "8" => "q4", "9" => "q4",
        "a" => "q4", "b" => "q4", "c" => "q4", "d" => "q4", "e" => "q24", "f" => "q4", "g" => "q4", "h" => "q4", "i" => "q4", "j" => "q4",
        "k" => "q4", "l" => "q4", "m" => "q4", "n" => "q4", "o" => "q4", "p" => "q4", "q" => "q4", "r" => "q4", "s" => "q4", "t" => "q4",
        "u" => "q4", "v" => "q4", "w" => "q4", "x" => "q4", "y" => "q4", "z" => "q4"
    ),
    
    "q24" => array( // re
        "0" => "q4", "1" => "q4", "2" => "q4", "3" => "q4", "4" => "q4", "5" => "q4", "6" => "q4", "7" => "q4", "8" => "q4", "9" => "q4",
        "a" => "q25", "b" => "q4", "c" => "q4", "d" => "q4", "e" => "q4", "f" => "q4", "g" => "q4", "h" => "q4", "i" => "q4", "j" => "q4",
        "k" => "q4", "l" => "q4", "m" => "q4", "n" => "q4", "o" => "q4", "p" => "q4", "q" => "q4", "r" => "q4", "s" => "q4", "t" => "q4",
        "u" => "q4", "v" => "q4", "w" => "q4", "x" => "q4", "y" => "q4", "z" => "q4"
    ),
    
    "q25" => array( // rea
        "0" => "q4", "1" => "q4", "2" => "q4", "3" => "q4", "4" => "q4", "5" => "q4", "6" => "q4", "7" => "q4", "8" => "q4", "9" => "q4",
        "a" => "q4", "b" => "q4", "c" => "q4", "d" => "q26", "e" => "q4", "f" => "q4", "g" => "q4", "h" => "q4", "i" => "q4", "j" => "q4",
        "k" => "q4", "l" => "q4", "m" => "q4", "n" => "q4", "o" => "q4", "p" => "q4", "q" => "q4", "r" => "q4", "s" => "q4", "t" => "q4",
        "u" => "q4", "v" => "q4", "w" => "q4", "x" => "q4", "y" => "q4", "z" => "q4"
    ),
    
    "q26" => array( // read
        "0" => "q4", "1" => "q4", "2" => "q4", "3" => "q4", "4" => "q4", "5" => "q4", "6" => "q4", "7" => "q4", "8" => "q4", "9" => "q4",
        "a" => "q4", "b" => "q4", "c" => "q4", "d" => "q4", "e" => "q4", "f" => "q4", "g" => "q4", "h" => "q4", "i" => "q4", "j" => "q4",
        "k" => "q4", "l" => "q4", "m" => "q4", "n" => "q4", "o" => "q4", "p" => "q4", "q" => "q4", "r" => "q4", "s" => "q4", "t" => "q4",
        "u" => "q4", "v" => "q4", "w" => "q4", "x" => "q4", "y" => "q4", "z" => "q4"
    ),

    // ========================================================================
    // RECONHECIMENTO: ELSE
    // ========================================================================
    "q38" => array( // e
        "0" => "q4", "1" => "q4", "2" => "q4", "3" => "q4", "4" => "q4", "5" => "q4", "6" => "q4", "7" => "q4", "8" => "q4", "9" => "q4",
        "a" => "q4", "b" => "q4", "c" => "q4", "d" => "q4", "e" => "q4", "f" => "q4", "g" => "q4", "h" => "q4", "i" => "q4", "j" => "q4",
        "k" => "q4", "l" => "q40", "m" => "q4", "n" => "q4", "o" => "q4", "p" => "q4", "q" => "q4", "r" => "q4", "s" => "q4", "t" => "q4",
        "u" => "q4", "v" => "q4", "w" => "q4", "x" => "q4", "y" => "q4", "z" => "q4"
    ),
    
    "q40" => array( // el
        "0" => "q4", "1" => "q4", "2" => "q4", "3" => "q4", "4" => "q4", "5" => "q4", "6" => "q4", "7" => "q4", "8" => "q4", "9" => "q4",
        "a" => "q4", "b" => "q4", "c" => "q4", "d" => "q4", "e" => "q4", "f" => "q4", "g" => "q4", "h" => "q4", "i" => "q4", "j" => "q4",
        "k" => "q4", "l" => "q4", "m" => "q4", "n" => "q4", "o" => "q4", "p" => "q4", "q" => "q4", "r" => "q4", "s" => "q41", "t" => "q4",
        "u" => "q4", "v" => "q4", "w" => "q4", "x" => "q4", "y" => "q4", "z" => "q4"
    ),
    
    "q41" => array( // els
        "0" => "q4", "1" => "q4", "2" => "q4", "3" => "q4", "4" => "q4", "5" => "q4", "6" => "q4", "7" => "q4", "8" => "q4", "9" => "q4",
        "a" => "q4", "b" => "q4", "c" => "q4", "d" => "q4", "e" => "q42", "f" => "q4", "g" => "q4", "h" => "q4", "i" => "q4", "j" => "q4",
        "k" => "q4", "l" => "q4", "m" => "q4", "n" => "q4", "o" => "q4", "p" => "q4", "q" => "q4", "r" => "q4", "s" => "q4", "t" => "q4",
        "u" => "q4", "v" => "q4", "w" => "q4", "x" => "q4", "y" => "q4", "z" => "q4"
    ),
    
    "q42" => array( // else
        "0" => "q4", "1" => "q4", "2" => "q4", "3" => "q4", "4" => "q4", "5" => "q4", "6" => "q4", "7" => "q4", "8" => "q4", "9" => "q4",
        "a" => "q4", "b" => "q4", "c" => "q4", "d" => "q4", "e" => "q4", "f" => "q4", "g" => "q4", "h" => "q4", "i" => "q4", "j" => "q4",
        "k" => "q4", "l" => "q4", "m" => "q4", "n" => "q4", "o" => "q4", "p" => "q4", "q" => "q4", "r" => "q4", "s" => "q4", "t" => "q4",
        "u" => "q4", "v" => "q4", "w" => "q4", "x" => "q4", "y" => "q4", "z" => "q4"
    ),

    // ========================================================================
    // RECONHECIMENTO: VAR
    // ========================================================================
    "q39" => array( // v
        "0" => "q4", "1" => "q4", "2" => "q4", "3" => "q4", "4" => "q4", "5" => "q4", "6" => "q4", "7" => "q4", "8" => "q4", "9" => "q4",
        "a" => "q43", "b" => "q4", "c" => "q4", "d" => "q4", "e" => "q4", "f" => "q4", "g" => "q4", "h" => "q4", "i" => "q4", "j" => "q4",
        "k" => "q4", "l" => "q4", "m" => "q4", "n" => "q4", "o" => "q4", "p" => "q4", "q" => "q4", "r" => "q4", "s" => "q4", "t" => "q4",
        "u" => "q4", "v" => "q4", "w" => "q4", "x" => "q4", "y" => "q4", "z" => "q4"
    ),
    
    "q43" => array( // va
        "0" => "q4", "1" => "q4", "2" => "q4", "3" => "q4", "4" => "q4", "5" => "q4", "6" => "q4", "7" => "q4", "8" => "q4", "9" => "q4",
        "a" => "q4", "b" => "q4", "c" => "q4", "d" => "q4", "e" => "q4", "f" => "q4", "g" => "q4", "h" => "q4", "i" => "q4", "j" => "q4",
        "k" => "q4", "l" => "q4", "m" => "q4", "n" => "q4", "o" => "q4", "p" => "q4", "q" => "q4", "r" => "q44", "s" => "q4", "t" => "q4",
        "u" => "q4", "v" => "q4", "w" => "q4", "x" => "q4", "y" => "q4", "z" => "q4"
    ),
    
    "q44" => array( // var
        "0" => "q4", "1" => "q4", "2" => "q4", "3" => "q4", "4" => "q4", "5" => "q4", "6" => "q4", "7" => "q4", "8" => "q4", "9" => "q4",
        "a" => "q4", "b" => "q4", "c" => "q4", "d" => "q4", "e" => "q4", "f" => "q4", "g" => "q4", "h" => "q4", "i" => "q4", "j" => "q4",
        "k" => "q4", "l" => "q4", "m" => "q4", "n" => "q4", "o" => "q4", "p" => "q4", "q" => "q4", "r" => "q4", "s" => "q4", "t" => "q4",
        "u" => "q4", "v" => "q4", "w" => "q4", "x" => "q4", "y" => "q4", "z" => "q4"
    ),

    // ========================================================================
    // NÚMEROS E IDENTIFICADORES GERAIS
    // ========================================================================
    "q3" => array( // Números inteiros
        "0" => "q3", "1" => "q3", "2" => "q3", "3" => "q3", "4" => "q3",
        "5" => "q3", "6" => "q3", "7" => "q3", "8" => "q3", "9" => "q3",
        "." => "q27"
    ),
    
    "q27" => array( // Números flutuantes
        "0" => "q27", "1" => "q27", "2" => "q27", "3" => "q27", "4" => "q27",
        "5" => "q27", "6" => "q27", "7" => "q27", "8" => "q27", "9" => "q27"
    ),
    
    "q4" => array( // Identificadores gerais
        "0" => "q4", "1" => "q4", "2" => "q4", "3" => "q4", "4" => "q4", "5" => "q4", "6" => "q4", "7" => "q4", "8" => "q4", "9" => "q4",
        "a" => "q4", "b" => "q4", "c" => "q4", "d" => "q4", "e" => "q4", "f" => "q4", "g" => "q4", "h" => "q4", "i" => "q4", "j" => "q4",
        "k" => "q4", "l" => "q4", "m" => "q4", "n" => "q4", "o" => "q4", "p" => "q4", "q" => "q4", "r" => "q4", "s" => "q4", "t" => "q4",
        "u" => "q4", "v" => "q4", "w" => "q4", "x" => "q4", "y" => "q4", "z" => "q4"
    ),

    // ========================================================================
    // ESTADOS FINAIS SIMPLES
    // ========================================================================
    "q5"  => array(), // Espaços
    "q6"  => array(), // (
    "q7"  => array(), // )
    "q8"  => array(), // >
    "q9"  => array(), // {
    "q28" => array(), // *
    "q29" => array(), // -
    "q30" => array(), // +
    "q31" => array(), // /
    "q32" => array(), // ;
    "q33" => array(), // }
    "q34" => array(), // <
    "q35" => array()  // =
);

// ============================================================================
// MAPEAMENTO DOS ESTADOS FINAIS
// ============================================================================

$finais = array(
    "q1"  => "ID",
    "q2"  => "IF", 
    "q3"  => "CONST",
    "q4"  => "ID",  
    "q5"  => "WS",
    "q6"  => "AP",
    "q7"  => "FP", 
    "q8"  => "MAIOR",
    "q9"  => "INIBLOCO",
    "q12" => "FOR",
    "q17" => "WHILE", 
    "q22" => "PRINT",
    "q26" => "READ",
    "q27" => "FLUTUANTEL",
    "q28" => "MULTIPLICACAO",
    "q29" => "SUBTRACAO", 
    "q30" => "SOMA",
    "q31" => "DIVISAO",
    "q32" => "PV",
    "q33" => "FIMBLOCO",
    "q34" => "MENOR",
    "q35" => "ATRIBUICAO", 
    "q42" => "ELSE",
    "q44" => "VAR"
);

// ============================================================================
// PROCESSAMENTO
// ============================================================================

$lista_tokens = array();
$estado = "q0";
$entrada = " if (a > 3) { var x = 10; print(x); read(y); } else while (y < 5) { y = y + 1; } ";
$i = 0;
$lexema = "";
$pos = 0;

while ($i < strlen($entrada)) {
    if (array_key_exists($entrada[$i], $afd[$estado])) {
        $estado = $afd[$estado][$entrada[$i]];
        $lexema .= $entrada[$i];
        $pos++;
        $i++; 
    } elseif (array_key_exists($estado, $finais)) {
        if ($finais[$estado] != "WS") { // Ignora espaços
            array_push($lista_tokens, new Token($finais[$estado], $lexema, $pos));  
        }
        $estado = "q0";
        $lexema = "";        
    } else {
        echo "Erro: token inválido: ". $lexema.$entrada[$i];
        break;
    }
}

// Token final se existir
if (!empty($lexema) && array_key_exists($estado, $finais)) {
    if ($finais[$estado] != "WS") {
        array_push($lista_tokens, new Token($finais[$estado], $lexema, $pos));
    }
}

foreach ($lista_tokens as $tk)
    echo $tk."\n";

?>